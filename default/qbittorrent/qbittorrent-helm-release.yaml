---
apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: qbittorrent
  namespace: default
  annotations:
    fluxcd.io/ignore: "false"
    fluxcd.io/automated: "false"
spec:
  releaseName: qbittorrent
  rollback:
    enable: false
  chart:
    repository: https://k8s-at-home.com/charts
    name: qbittorrent
    version: 5.0.1
  values:
    qbittorrent:
      image:
        repository: linuxserver/qbittorrent
        tag: 14.3.0.99202010231047-7094-260e48b70ubuntu18.04.1-ls96
      env:
        TZ: America/Santiago
        PUID: 1000
        PGID: 1000
        UMASK: "022"

      btService:
        port: 50413

      ingress:
        enabled: true
        annotations:
          kubernetes.io/ingress.class: "nginx"

      persistence:
        type: deployment
        config:
          enabled: true
          size: 1Gi
          storageClass: longhorn
        media:
          enabled: false

      additionalVolumeMounts:
        - name: media
          mountPath: "/data"
      additionalVolumes:
        - name: media
          persistentVolumeClaim:
            claimName: nfs-media-pvc

      resources:
        requests:
          memory: 250Mi
          cpu: 25m
        limits:
          memory: 1500Mi

  valueFileSecrets:
  - name: "qbittorrent-values"

